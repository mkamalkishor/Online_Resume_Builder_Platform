{% extends 'base.html' %}
{% block title %}Login - ResumeBuilder{% endblock %}

{% block content %}

<style>
    /* Center the card vertically and horizontally */
    .login-container {
        min-height: 80vh;
        /* Takes up most of the screen height */
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .card-login {
        border: none;
        border-radius: 1rem;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        /* Soft, professional shadow */
        overflow: hidden;
        /* Keeps content inside rounded corners */
    }

    .form-floating>.form-control:focus~label {
        color: var(--primary-color);
        /* Highlight label on focus */
    }

    .form-control:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 0.25rem rgba(79, 70, 229, 0.25);
    }
</style>

<div class="login-container">
    <div class="col-md-5 col-lg-4">

        <div class="card card-login bg-white p-5">

            <div class="text-center mb-4">
                <div class="mb-3">
                    <i class="bi bi-file-earmark-person-fill text-primary" style="font-size: 3rem;"></i>
                </div>
                <h3 class="fw-bold text-dark">Welcome Back</h3>
                <p class="text-muted small">Please enter your details to sign in.</p>
            </div>

            {% if error == "invalid" %}
            <div class="alert alert-danger d-flex align-items-center mb-4" role="alert">
                <i class="bi bi-exclamation-triangle-fill me-2"></i>
                <div>Invalid username or password</div>
            </div>
            {% endif %}

            <form method="post" class="needs-validation" id="loginForm" novalidate>
                {% csrf_token %}

                <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="usernameInput" name="username" placeholder="Username"
                        required>
                    <label for="usernameInput">Username</label>
                    <div class="invalid-feedback">
                        Please enter your username.
                    </div>
                </div>

                <div class="form-floating mb-3">
                    <input type="password" class="form-control" id="passwordInput" name="password"
                        placeholder="Password" required>
                    <label for="passwordInput">Password</label>
                    <div class="invalid-feedback">
                        Please enter your password.
                    </div>
                </div>

                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="rememberMe">
                        <label class="form-check-label text-muted small" for="rememberMe">
                            Remember me
                        </label>
                    </div>
                    <a href="#" class="text-primary small text-decoration-none fw-bold">Forgot Password?</a>
                </div>

                <button type="submit" class="btn btn-custom-register w-100 btn-lg py-2">
                    Sign In
                </button>
            </form>

            <div class="text-center mt-4">
                <p class="text-muted small mb-0">
                    Don't have an account?
                    <a href="{% url 'register' %}" class="text-primary fw-bold text-decoration-none">Create account</a>
                </p>
            </div>
        </div>

    </div>
</div>

<script>
    // Wait for the DOM to be ready
    document.addEventListener('DOMContentLoaded', function () {

        const form = document.getElementById('loginForm');

        form.addEventListener('submit', function (event) {
            // Check if the form is valid according to HTML5 rules (required, type, etc.)
            if (!form.checkValidity()) {
                event.preventDefault(); // Stop submission if invalid
                event.stopPropagation(); // Stop bubbling
            }

            // This adds the Bootstrap class that triggers the green/red borders
            form.classList.add('was-validated');
        }, false);
    });
</script>

{% endblock %}